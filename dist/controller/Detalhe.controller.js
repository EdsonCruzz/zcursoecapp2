sap.ui.define(["zcursoecapp2/controller/App.controller","sap/ui/model/json/JSONModel","sap/m/MessageBox"],function(e,t,i){"use strict";return e.extend("zcursoecapp2.controller.Detalhe",{onInit:function(){this.getRouter().getRoute("RouteDetalhe").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){let i=new t;let o={editable:false,visibleEdit:true,visibleSave:false};i.setData(o);this.getView().setModel(i,"Auxiliar");let a=e.getParameter("arguments").id;this.getModel().refresh();this.getModel().metadataLoaded().then(function(){var e=this.getModel().createKey("AlunosFioriEDSONCRSet",{Usuario:a});this._bindView("/"+e)}.bind(this))},_bindView:function(e){var t=this.getView().getModel();var i=this;t.setProperty("/busy",false);this.getView().bindElement({path:e,events:{change:this._onBindingChange.bind(this),dataRequested:function(){t.setProperty("/busy",true)},dataReceived:function(){t.setProperty("/busy",false)}}})},_onBindingChange:function(){var e=this.getView(),t=e.getElementBinding();if(!t.getBoundContext()){return}},onEdita:function(){let e=this.getView().getModel("Auxiliar");let t=e.getData();t.editable=true;t.visibleEdit=false,t.visibleSave=true;e.refresh()},onCancela:function(){let e=this.getView().getModel();e.refresh();let t=this;sap.m.MessageBox.alert("Confirma o cancelamento da edição?",{actions:["Sim","Não"],onClose:function(e){let i=t.getView().getModel("Auxiliar");let o=i.getData();o.editable=false;o.visibleEdit=true;o.visibleSave=false;i.refresh()}})},onSalva:function(){let e=this.getView().byId("idNome").getValue();let t=this.getView().byId("Email").getValue();let i=this.getView().byId("ProjetoSegw").getValue();let o=this.getView().byId("idCep").getValue();let a=this.getView().byId("idEndereco").getValue();let s=this.getView().byId("idBairro").getValue();let n=this;let l=this.getView().byId("Usuario").getValue();let r={Nome:e,ProjetoSegw:i,Email:t,Cep:o,Endereco:a,Bairro:s};this.getView().getModel().update("/AlunosFioriEDSONCRSet('"+l+"')",r,{success:function(e,t){sap.m.MessageBox.success("Usuario atualizado com sucesso!!!",{actions:["Ok"],onClose:function(e){n.onCancela();n.getRouter().navTo("RouteView1")}})},error:function(e){sap.m.MessageBox.error("Erro ao atualizar o aluno !!!")}})},onChangeCEP:function(){let e=this;let t=this.getView().byId("idCep").getValue();let i=this.getView().getModel();var o="https://viacep.com.br/ws/"+t+"/json/";$.ajax({url:o,dataType:"jsonp",beforeSend:function(e){i.setProperty("/busy",true)},success:function(t){i.setProperty("/busy",false);let o=t.cep;let a=t.logradouro;let s=t.bairro;e.getView().byId("idCep").setValue(o);e.getView().byId("idEndereco").setValue(a);e.getView().byId("idBairro").setValue(s)},error:function(){i.setProperty("/busy",false)}})}})});
//# sourceMappingURL=Detalhe.controller.js.map